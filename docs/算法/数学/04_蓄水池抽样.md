# 蓄水池抽样算法

## 问题引入

我们如何从一个文件中随机选择一行

1. 每一行被选择的概率一样大
2. 文件很大，我们不能把整个文件加载到内存中

```
i = 0     # 当前读到的行数
s = null  # 最终要选择的哪一行；中奖池
for line in 文本文件 :
  i = i + 1
  r = 生成[0,1)之间的随机数  # 以1/i的概率将s替换成第i行
  if r < 1/i :
    s = line              # 结束：s随机指向任何一行
```

问题扩展，如何从一个文件中随机选择 K 行？

```
i=0
s=[] # 下标从1开始；中奖池
for line in 文本文件：
  i=i+1
  if i<=K :
    s.append(line)
  else
    j = [1,i] 间的随机整数
    if j<=K:
      s[j]=line
```
